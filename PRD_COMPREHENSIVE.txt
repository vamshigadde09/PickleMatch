ğŸ“˜ Product Requirements Document (PRD)
PickleMatch â€“ Social Pickleball Tournament App

Version: 2.0 (Comprehensive)
Platforms: Mobile App (React Native), Backend API (Node.js/Express/MongoDB)
Author: Development Team
Status: Implemented & Active
Last Updated: 2024

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. ğŸ¯ Product Overview

PickleMatch is a mobile-first social platform for pickleball groups that organizes matches,
shuffles teams, tracks winners, shows leaderboards, and stores comprehensive player stats.

The app eliminates the confusion of:
â€¢ Deciding who plays with whom
â€¢ Creating fair teams
â€¢ Generating match orders
â€¢ Tracking winners and points
â€¢ Maintaining consistent player stats across multiple games
â€¢ Managing unregistered players until they register

Players earn points individually and as teams, making the platform competitive and social.
The platform supports both registered and unregistered players, with seamless data migration
when unregistered players eventually register.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

2. ğŸ‘¥ User Roles & Permissions

2.1 Normal User
All users can:
â€¢ Create an account with username, display name, mobile number, and password
â€¢ Add friends via mobile number or username search
â€¢ Create a room (automatically becomes room admin)
â€¢ Join a room using room code
â€¢ Add players to rooms they're members of
â€¢ Create games (room members)
â€¢ Play matches
â€¢ Earn individual and team points
â€¢ View global leaderboards and top scores
â€¢ Search for players by name, username, or phone number (min 7 digits)
â€¢ View other users' profiles
â€¢ Manage their own profile
â€¢ Toggle phone number visibility
â€¢ View game history across all rooms

2.2 Room Admin (Automatically the creator of that room)
Controls:
â€¢ Room name and settings
â€¢ Room status (active/inactive) - deactivate/activate room
â€¢ Game format selection
â€¢ Player selection
â€¢ Team generation
â€¢ Match flow management
â€¢ Winner selection
â€¢ Shuffling teams
â€¢ Ending a game
â€¢ All member capabilities

Room Status Control:
â€¢ Admin can deactivate room (prevents creating/joining other rooms)
â€¢ Admin cannot create or join other rooms while their room is active
â€¢ Other members can still join and participate in active rooms

2.3 Room Members
Can:
â€¢ View room dashboard
â€¢ View players list
â€¢ Add players to the room (via "Add Members" button)
â€¢ Create and participate in games
â€¢ View leaderboard and history
â€¢ Earn points

Cannot:
â€¢ Modify room settings (name, status)
â€¢ Delete the room

2.4 Unregistered Players
â€¢ Can participate in games before registration
â€¢ Points and match history stored temporarily
â€¢ When registering with same phone number:
  â€¢ All historical data automatically linked
  â€¢ Names replaced with system-generated unique identifiers for privacy
  â€¢ Points and stats transferred to registered account

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

3. ğŸ§­ Navigation Structure

3.1 Bottom Tab Navigation
1. Home Tab
   â€¢ Join Room (via room code)
   â€¢ Create Room
   â€¢ Active Rooms List
   â€¢ Game History (across all rooms)

2. Top Scores Tab
   â€¢ Top Individual Players
     - Sortable by: Points, Wins, Streak
     - Global leaderboard
     - Player cards with stats
   â€¢ Seasonal Leaderboard
     - Weekly/Monthly filters
     - Metrics: Points, Wins, Streak, Games
   â€¢ Search Players (header button)
     - Search by name, username, or phone (min 7 digits)
     - Add Friend / View Profile buttons

3. Profile Tab
   â€¢ Personal Information
   â€¢ Game Statistics (total games, wins, streak, win %)
   â€¢ Individual & Team Points
   â€¢ Partner Statistics
     - Best Partner
     - Most Frequent Teammate
   â€¢ Friends List
   â€¢ Settings
     - Edit profile
     - Toggle phone number visibility
     - Logout

3.2 Stack Navigation (Nested Screens)
â€¢ Authentication
  - Login Screen
  - Register Screen

â€¢ Room Management
  - Create Room Screen
  - Room Dashboard Screen
  - Add Players to Room Screen

â€¢ Game Flow
  - Select Members Screen
  - Choose Game Format Screen
  - Team Assignment Screen
  - Active Match Screen
  - Game Results Screen

â€¢ Profile & Discovery
  - User Profile View Screen (view other users)
  - History Screen

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

4. ğŸ” Features Breakdown

â­ 4.1 Home Screen

ğŸ’  4.1.1 Join Room
â€¢ User enters a room code (6-character alphanumeric)
â€¢ System checks if:
  - User already exists in that room â†’ auto-join
  - Room exists and is active â†’ join as member
  - Room is inactive â†’ cannot join
â€¢ Room creator automatically included as a player
â€¢ Other players can join using room code

ğŸ’  4.1.2 Create Room
â€¢ User enters:
  - Room name (minimum 3 characters)
  - Optional: Add players initially (can be empty)
  - Optional toggle: Show mobile number publicly
â€¢ Room code automatically generated (unique, fixed)
â€¢ Room creator automatically added as first player
â€¢ Room can be created empty - others can join via code
â€¢ Room status defaults to "active"

ğŸ’  4.1.3 Active Rooms
â€¢ List of rooms user is member of
â€¢ Shows room name, code, status
â€¢ Quick access to room dashboard
â€¢ Filter by active/inactive status

ğŸ’  4.1.4 Game History
â€¢ List of all past games across all rooms:
  - Room name
  - Date and time
  - Game type/format
  - Winning team and players
  - Individual points earned
  - Team points earned
  - Medal winners (Gold, Silver, Bronze)
â€¢ Users can tap to see:
  - Full match breakdown
  - All teams and players
  - Detailed scores
  - Points distribution

â­ 4.2 Top Scores Screen

ğŸ’  4.2.1 Top Individual Players
â€¢ Global leaderboard of all registered users
â€¢ Sortable by:
  - Total individual points (default)
  - Total wins
  - Current streak
â€¢ Each card shows:
  - Rank (with medals for top 3: ğŸ¥‡ğŸ¥ˆğŸ¥‰)
  - Player avatar/initials
  - Display name and username
  - Total points
  - Total wins
  - Win percentage
  - Current streak
â€¢ Pull-to-refresh to update
â€¢ Limit: Top 50 players

ğŸ’  4.2.2 Seasonal Leaderboard
â€¢ Filterable by:
  - Period: Weekly / Monthly
  - Metric: Points / Wins / Streak / Games Played
â€¢ Shows performance for selected time period
â€¢ Each card shows relevant seasonal stats
â€¢ Limit: Top 50 players

ğŸ’  4.2.3 Search Players (NEW)
â€¢ Search button in header
â€¢ Search modal with input field
â€¢ Search by:
  - Name (partial match, case-insensitive)
  - Username (partial match, case-insensitive)
  - Phone number (minimum 7 digits required for privacy)
â€¢ Real-time search with 500ms debounce
â€¢ Results show:
  - Player avatar/initials
  - Display name
  - Username
  - Masked phone (last 4 digits) if phone search
  - Action buttons:
    â€¢ "Add Friend" (if not friends)
    â€¢ "View Profile" (if already friends)
    â€¢ "You" (disabled, if viewing own profile)
â€¢ Click "View Profile" to see full user profile
â€¢ Click "Add Friend" to send friend request

â­ 4.3 Profile Screen

ğŸ’  4.3.1 Personal Information
â€¢ Display name
â€¢ Username (@username)
â€¢ Avatar (or initials if no avatar)
â€¢ Mobile number (if visibility toggle is ON)
â€¢ Account creation date

ğŸ’  4.3.2 Game Statistics
â€¢ Total Games Played
â€¢ Total Wins
â€¢ Current Win Streak
â€¢ Win Percentage (calculated automatically)
â€¢ Individual Points (lifetime)
â€¢ Team Points (lifetime)

ğŸ’  4.3.3 Partner Statistics
â€¢ Best Partner:
  - Player name and avatar
  - Games played together
  - Wins together
  - Win rate percentage
  - Requires minimum 3 games together
â€¢ Most Frequent Teammate:
  - Player name and avatar
  - Total games played together

ğŸ’  4.3.4 Friends List
â€¢ List of all friends
â€¢ Shows:
  - Friend's avatar/initials
  - Display name
  - Username
  - Individual points
â€¢ Tap friend to view their profile
â€¢ Add friend button:
  - Search by mobile number OR username
  - Real-time validation
â€¢ Remove friend functionality

ğŸ’  4.3.5 Settings & Actions
â€¢ Edit Profile:
  - Update display name
  - Update avatar URL
  - Update username (unique validation)
â€¢ Toggle Phone Number Visibility:
  - ON: Phone visible to friends and in profile searches
  - OFF: Phone hidden (privacy mode)
â€¢ Logout:
  - Clears authentication
  - Returns to login screen

â­ 4.4 User Profile View Screen (NEW)

ğŸ’  4.4.1 Viewing Other Users' Profiles
â€¢ Accessible from:
  - Search results (if already friends)
  - Friends list
  - Top Scores leaderboard (future)
â€¢ Shows:
  - Profile header with gradient
  - Avatar and basic info
  - Game statistics (points, wins, games, streak, win %)
  - Phone number (only if user has visibility ON or you're viewing yourself)
  - Friend status badge or "Add Friend" button
â€¢ Cannot edit other users' profiles
â€¢ Respects privacy settings

ğŸ’  4.4.2 Add Friend from Profile
â€¢ "Add Friend" button on non-friend profiles
â€¢ One-click friend request
â€¢ Updates friend status immediately
â€¢ Shows success notification

â­ 4.5 Room Dashboard Screen

ğŸ’  4.5.1 Room Information
â€¢ Room name and code
â€¢ Room status (Active/Inactive)
â€¢ Copy room code to clipboard (silent, no alert)
â€¢ Created by information
â€¢ Member count

ğŸ’  4.5.2 Header Actions
â€¢ Add Members Button (all members):
  - Opens Add Players to Room screen
  - Can add from friends, contacts, or manual entry
â€¢ Deactivate/Activate Button (room creator only):
  - Toggle room status
  - Visual indicator (red = active, green = inactive)
  - Prevents creator from creating/joining other rooms if active

ğŸ’  4.5.3 Players Section
â€¢ Tap on "Players" count to view modal
â€¢ Modal shows:
  - All players (registered and unregistered)
  - For registered: Username (@username) and Individual Points
  - For unregistered: Display name only
  - Avatar/initials for each player

ğŸ’  4.5.4 Active Game
â€¢ Shows current active game if exists
â€¢ Game format and status
â€¢ "Continue Game" button
â€¢ "Create New Game" button (only if no active game)
â€¢ Prevents multiple active games per room

ğŸ’  4.5.5 Leaderboard (When No Active Game)
â€¢ Top 3 players with podium display:
  - ğŸ¥‡ First place (gold)
  - ğŸ¥ˆ Second place (silver)
  - ğŸ¥‰ Third place (bronze)
â€¢ Shows:
  - Player avatar/initials
  - Display name or username
  - Total points in this room
â€¢ Based on points earned in completed games within this room

ğŸ’  4.5.6 Game History
â€¢ List of completed games in this room
â€¢ Quick access to game results

â­ 4.6 Add Players to Room Screen (NEW)

ğŸ’  4.6.1 Adding Players
â€¢ Three methods:
  1. From Friends List
     - Select from existing friends
     - Shows friend's username and points
  2. From Device Contacts
     - Import contacts with phone numbers
     - Match with existing users or create unregistered players
  3. Manual Entry
     - Enter name and phone number
     - Creates unregistered player if user doesn't exist
â€¢ Any room member can add players
â€¢ Updates room's players array
â€¢ New players become room members if registered

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

5ï¸âƒ£ Game Formats & Creation Flow

ğŸ’  5.1 Available Game Formats

1ï¸âƒ£ 1 vs 1 Format
â€¢ Description: Direct one-on-one match
â€¢ Required Players: Exactly 2
â€¢ Format: Single match
â€¢ Winner: Match winner gets Gold, runner-up gets Silver
â€¢ Visibility: Only shown when exactly 2 players selected

2ï¸âƒ£ 2 vs 2 Format
â€¢ Description: Classic doubles match
â€¢ Required Players: Exactly 4
â€¢ Format: Single match (Team A vs Team B)
â€¢ Winner: Winning team gets Gold, runner-up gets Silver
â€¢ Visibility: Only shown when exactly 4 players selected

3ï¸âƒ£ Pickle Format
â€¢ Description: Full tournament with winners bracket, losers bracket, and final
â€¢ Required Players: 4+ players (handles odd numbers with "plays twice")
â€¢ Format: Structured bracket tournament
â€¢ Rounds:
  - Round 1: Initial matches
  - Winners Bracket: Advancing teams
  - Losers Bracket: Second chance
  - Championship: Final match
â€¢ Medals: Gold (Final winner), Silver (Final runner-up), Bronze (Losers bracket winner)
â€¢ Visibility: Shown when 4+ players selected

4ï¸âƒ£ Round Robin Format
â€¢ Description: Every team plays every other team
â€¢ Required Players: 4+ players (handles odd numbers)
â€¢ Format: All teams face each other once
â€¢ Winner: Ranked by total wins, then point differences
â€¢ Medals: Gold (Most wins), Silver (2nd place), Bronze (3rd place)
â€¢ Visibility: Shown when 4+ players selected

5ï¸âƒ£ Quick Knockout Format
â€¢ Description: Fast single-elimination bracket
â€¢ Required Players: 4+ players (preferably even)
â€¢ Format: Quarterfinals â†’ Semifinals â†’ Final
â€¢ Winner: Single elimination bracket
â€¢ Medals: Gold (Final winner), Silver (Final runner-up), Bronze (3rd place playoff winner)
â€¢ Visibility: Shown when 4+ players selected

ğŸ’  5.2 Step 1 â€” Select Members

â€¢ Minimum players: 2 (for 1v1 format)
â€¢ Maximum players: No limit (handled by format requirements)
â€¢ Current user automatically included
â€¢ Select from room players:
  - Registered users (show username)
  - Unregistered players (show name)
â€¢ Can select players from:
  - Friends list
  - Room members
  - Add new players on the fly
â€¢ Validation: Must meet format requirements after selection

ğŸ’  5.3 Step 2 â€” Choose Game Format

â€¢ Shows available formats based on selected player count:
  - 2 players â†’ Only 1v1 shown
  - 4 players â†’ All formats shown (1v1, 2v2, tournament formats)
  - 4+ players â†’ Tournament formats shown (Pickle, Round Robin, Quick Knockout)
â€¢ Each format card shows:
  - Format name and icon
  - Description
  - Required players
  - Medal system
  - Details about format structure
â€¢ User taps to select format

ğŸ’  5.4 Step 3 â€” Team Assignment

â€¢ System auto-generates teams based on format
â€¢ Team assignment logic:

**For 1v1:**
- Player 1 vs Player 2

**For 2v2:**
- Team A: Player 1 + Player 2
- Team B: Player 3 + Player 4

**For Tournament Formats (4+ players):**
- Teams of 2 players each
- Odd Player Handling:
  * If odd number of players, one player "plays twice"
  * Player marked with "Plays Twice" badge
  * Ensures all players participate fairly

â€¢ Admin options:
  - Shuffle Teams (randomize assignments)
  - Accept Teams (proceed to game)

ğŸ’  5.5 Step 4 â€” Game Screen (Active Match)

â€¢ Shows current match:
  - Team A vs Team B
  - Player names
  - Match number and round information
â€¢ Match timeline visualization:
  - Shows completed matches
  - Highlights current match
  - Shows upcoming matches
â€¢ Admin actions:
  - Select winning team
  - Enter final scores
  - Submit match result
â€¢ System automatically:
  - Determines next matches based on format
  - Updates bracket/bracket status
  - Tracks progression

ğŸ’  5.6 Step 5 â€” Game Results

â€¢ Shows final results based on format:

**For 1v1/2v2:**
- Winner name and score
- Runner-up name and score
- Simple display (no medal cards)

**For Tournament Formats:**
- Medal Winners:
  * ğŸ¥‡ Gold Medal: Team and players
  * ğŸ¥ˆ Silver Medal: Team and players
  * ğŸ¥‰ Bronze Medal: Team and players
- Match Details:
  * All matches played
  * Scores for each match
  * Winner of each match

â€¢ Points automatically assigned:
  - Individual points for medal winners
  - Team points for medal-winning teams
  - Participation points for all players
â€¢ Statistics updated:
  - User total games, wins, streak
  - Points added to user accounts

ğŸ’  5.7 Game Flow Control

â€¢ Only one active game per room at a time
â€¢ If active game exists:
  - "Create New Game" button hidden
  - Shows "Continue Game" option
  - Prevents duplicate games
â€¢ Navigation flow:
  - Team Assignment â†’ Active Match (replace navigation)
  - Back button from Active Match â†’ Room Dashboard
  - Prevents accidental game recreation

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

6. ğŸ… Points & Medal System

ğŸ’  6.1 Medal Assignment

**1 vs 1 Format:**
â€¢ ğŸ¥‡ Gold: Match winner
â€¢ ğŸ¥ˆ Silver: Match runner-up

**2 vs 2 Format:**
â€¢ ğŸ¥‡ Gold: Winning team (both players)
â€¢ ğŸ¥ˆ Silver: Runner-up team (both players)

**Pickle Format:**
â€¢ ğŸ¥‡ Gold: Final match winner
â€¢ ğŸ¥ˆ Silver: Final match runner-up
â€¢ ğŸ¥‰ Bronze: Losers bracket winner

**Round Robin Format:**
â€¢ ğŸ¥‡ Gold: Team with most wins
â€¢ ğŸ¥ˆ Silver: Team with 2nd most wins
â€¢ ğŸ¥‰ Bronze: Team with 3rd most wins
â€¢ Ties resolved by point differences

**Quick Knockout Format:**
â€¢ ğŸ¥‡ Gold: Final match winner
â€¢ ğŸ¥ˆ Silver: Final match runner-up
â€¢ ğŸ¥‰ Bronze: 3rd place playoff winner

ğŸ’  6.2 Points Distribution

| Placement | Medal | Individual Points | Team Points |
|-----------|-------|------------------|-------------|
| 1st Place | ğŸ¥‡ Gold | +10 | +10 |
| 2nd Place | ğŸ¥ˆ Silver | +7 | +7 |
| 3rd Place | ğŸ¥‰ Bronze | +5 | +5 |
| Participation | â€” | +2 | â€” |

â€¢ Points are cumulative (lifetime totals)
â€¢ Individual points tracked per user
â€¢ Team points tracked per user (sum of all team wins)
â€¢ Points persist across all games and rooms

ğŸ’  6.3 Statistics Tracking

**User Statistics:**
â€¢ Total Games: Incremented when game completes
â€¢ Total Wins: Incremented when user wins Gold medal
â€¢ Current Streak: 
  - Incremented when user wins
  - Reset to 0 when user doesn't win
â€¢ Win Percentage: (Total Wins / Total Games) Ã— 100

**Partner Statistics:**
â€¢ Best Partner: Highest win rate (min 3 games together)
â€¢ Most Frequent Teammate: Most games played together

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

7. ğŸ” Privacy & Security Features

ğŸ’  7.1 Phone Number Privacy

â€¢ Default: Phone numbers hidden
â€¢ User can toggle visibility in profile settings
â€¢ Phone visibility affects:
  - Profile display
  - Search results
  - Friend requests

ğŸ’  7.2 Search Privacy

â€¢ Phone number search requires minimum 7 digits
â€¢ Partial phone matching for privacy
â€¢ Phone numbers masked in search results (******1234)
â€¢ Name/username search: Full privacy, no restrictions

ğŸ’  7.3 Unregistered Player Privacy

â€¢ When unregistered player registers:
  - Original name replaced with system-generated unique identifier
  - Format: "userXXXX" (where XXXX is unique number)
  - Ensures no duplicate usernames
  - Preserves privacy of original entry name
  - All historical data linked seamlessly

ğŸ’  7.4 Data Migration & Linking

â€¢ Automatic data linking when unregistered player registers:
  - Matches by phone number only (not name)
  - All game history preserved
  - All points transferred
  - All match participation maintained
  - System-generated name replaces original names in all records

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

8. ğŸ“± User Interface & Experience

ğŸ’  8.1 Design Principles

â€¢ Modern, clean UI with purple accent color
â€¢ Consistent design language across all screens
â€¢ Card-based layouts with subtle shadows
â€¢ Gradient headers for important sections
â€¢ Responsive and touch-friendly
â€¢ Dark mode support (via theme)

ğŸ’  8.2 Key UI Components

â€¢ Custom Alert Modal:
  - Replaces native alerts
  - Consistent styling
  - Support for success, error, warning, info types
  - Customizable buttons

â€¢ Safe Area Handling:
  - Uses react-native-safe-area-context
  - Proper padding for all devices
  - Handles notches and status bars

â€¢ Loading States:
  - Activity indicators
  - Skeleton screens where appropriate
  - Pull-to-refresh support

â€¢ Empty States:
  - Friendly messages
  - Icon illustrations
  - Clear call-to-actions

ğŸ’  8.3 Navigation Patterns

â€¢ Bottom tab navigation for main sections
â€¢ Stack navigation for flows
â€¢ Modal presentations for details
â€¢ Back button handling (Android hardware back)
â€¢ Deep linking support (future)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

9. ğŸ”§ Technical Architecture

ğŸ’  9.1 Backend (Node.js/Express/MongoDB)

**API Structure:**
â€¢ RESTful API design
â€¢ JWT authentication
â€¢ MongoDB for data storage
â€¢ Mongoose ODM

**Main Endpoints:**
â€¢ `/api/v1/user/*` - User management, authentication, profile, friends, search
â€¢ `/api/v1/room/*` - Room CRUD, join, leaderboard, status
â€¢ `/api/v1/game/*` - Game creation, match results, points assignment
â€¢ `/api/v1/top-scores/*` - Global leaderboards, seasonal stats

**Data Models:**
â€¢ User: username, displayName, mobile, passwordHash, friends, stats, points
â€¢ Room: name, code, createdBy, members, players, status, history
â€¢ Game: roomId, type, teams, matches, medals, pointsAssigned, status
â€¢ Match: gameId, teams, winner, scores, status, roundNumber
â€¢ UnregisteredPlayer: name, mobile, pendingStats, linkedUserId

ğŸ’  9.2 Frontend (React Native/Expo)

**Technology Stack:**
â€¢ React Native with Expo
â€¢ React Navigation (Tabs + Stack)
â€¢ Axios for API calls
â€¢ AsyncStorage for local data
â€¢ Expo Linear Gradient
â€¢ React Native Safe Area Context

**State Management:**
â€¢ React Hooks (useState, useEffect, useCallback)
â€¢ Context API for authentication
â€¢ Local state for component data
â€¢ AsyncStorage for persistent auth

**Key Libraries:**
â€¢ @expo/vector-icons (Feather icons)
â€¢ expo-clipboard (copy functionality)
â€¢ react-native-gesture-handler

ğŸ’  9.3 Data Flow

**Authentication:**
1. User registers/logs in
2. JWT token stored in AsyncStorage
3. Token included in all API requests
4. Protected routes check token validity

**Game Flow:**
1. Create room â†’ Add players â†’ Select format â†’ Generate teams
2. Play matches â†’ Submit results â†’ Points assigned
3. Statistics updated â†’ Leaderboards refreshed

**Unregistered Player Flow:**
1. Player added to room/game with name and phone
2. Points and stats stored in UnregisteredPlayer model
3. When player registers with same phone:
   - Data automatically linked
   - Names replaced with system-generated IDs
   - Points and stats transferred to User account

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

10. ğŸ“Š Data Models

ğŸ’  10.1 User Model

{
  _id: ObjectId
  username: String (unique, lowercase)
  displayName: String
  mobile: String (unique, normalized)
  passwordHash: String
  showMobile: Boolean (default: false)
  avatarUrl: String (optional)
  friends: [ObjectId] (references User)
  individualPoints: Number (default: 0)
  teamPoints: Number (default: 0)
  stats: {
    totalGames: Number (default: 0)
    totalWins: Number (default: 0)
    streak: Number (default: 0)
  }
  createdAt: Date
  updatedAt: Date
}

ğŸ’  10.2 Room Model

{
  _id: ObjectId
  name: String (min 3 chars)
  code: String (unique, 6-char alphanumeric)
  createdBy: ObjectId (references User)
  members: [ObjectId] (references User)
  players: [{
    userId: ObjectId (references User, nullable)
    name: String
    mobile: String (normalized)
  }]
  showMobileNumber: Boolean (default: false)
  status: String (enum: 'active', 'inactive', default: 'active')
  history: [ObjectId] (references Game)
  createdAt: Date
  updatedAt: Date
}

ğŸ’  10.3 Game Model

{
  _id: ObjectId
  roomId: ObjectId (references Room)
  type: String (enum: 'one-vs-one', 'two-vs-two', 'pickle', 'round-robin', 'quick-knockout')
  status: String (enum: 'pending', 'live', 'completed', default: 'pending')
  teams: [{
    letter: String
    players: [{
      userId: ObjectId (nullable)
      name: String
      mobile: String
    }]
    medal: String (enum: 'gold', 'silver', 'bronze', null)
  }]
  matches: [ObjectId] (references Match)
  medals: {
    gold: {
      team: String
      players: [ObjectId]
    }
    silver: {
      team: String
      players: [ObjectId]
    }
    bronze: {
      team: String
      players: [ObjectId]
    }
  }
  pointsAssigned: Boolean (default: false)
  createdAt: Date
  updatedAt: Date
}

ğŸ’  10.4 Match Model

{
  _id: ObjectId
  gameId: ObjectId (references Game)
  roundNumber: Number
  bracketType: String (enum: 'winners', 'losers', 'final', etc.)
  team1: {
    letter: String
    players: [ObjectId or {name, mobile}]
    score: Number
  }
  team2: {
    letter: String
    players: [ObjectId or {name, mobile}]
    score: Number
  }
  winner: String (team letter)
  status: String (enum: 'pending', 'live', 'finished', default: 'pending')
  createdAt: Date
  updatedAt: Date
}

ğŸ’  10.5 UnregisteredPlayer Model

{
  _id: ObjectId
  name: String (original or system-generated)
  mobile: String (unique, normalized)
  linkedUserId: ObjectId (references User, nullable)
  linkedAt: Date (nullable)
  pendingStats: {
    totalGames: Number
    totalWins: Number
    games: [ObjectId] (references Game)
  }
  createdAt: Date
  updatedAt: Date
}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

11. ğŸ” Search & Discovery Features

ğŸ’  11.1 Player Search

**Search Methods:**
1. By Name: Partial match, case-insensitive
2. By Username: Partial match, case-insensitive
3. By Phone: Minimum 7 digits required

**Privacy Features:**
â€¢ Phone numbers masked in results (******1234)
â€¢ 7-digit minimum prevents easy phone number enumeration
â€¢ Results show friend status
â€¢ Click to add friend or view profile

**Search UI:**
â€¢ Search button in Top Scores header
â€¢ Modal overlay with search input
â€¢ Real-time search with 500ms debounce
â€¢ Loading states and error handling
â€¢ Empty states with helpful messages

ğŸ’  11.2 Friend Management

**Add Friend:**
â€¢ From search results
â€¢ From user profile view
â€¢ From profile screen (manual entry)
â€¢ Methods: Mobile number or username

**Friend List:**
â€¢ Displayed in profile
â€¢ Shows friend's stats and points
â€¢ Tap to view friend's profile
â€¢ Remove friend functionality

**Friend Status:**
â€¢ Checked in real-time
â€¢ Updates immediately after adding
â€¢ Visible in search results and profiles

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

12. ğŸ¨ UI/UX Enhancements

ğŸ’  12.1 Visual Design

â€¢ Color Palette:
  - Primary Accent: Purple (#8b5cf6)
  - Success: Green (#10b981)
  - Error: Red (#ef4444)
  - Background: Light gray (#f8fafc)
  - Cards: White with subtle shadows

â€¢ Typography:
  - Headers: Bold, 20-28px
  - Body: Regular, 14-16px
  - Labels: Medium weight, 12-14px

â€¢ Icons:
  - Feather icon set (consistent)
  - Contextual icons for actions
  - Medal emojis for winners

ğŸ’  12.2 Interactive Elements

â€¢ Touch Feedback:
  - Active opacity on buttons
  - Visual feedback on interactions
  - Loading states during operations

â€¢ Animations:
  - Smooth transitions
  - Confetti on game completion (optional)
  - Pull-to-refresh animations

â€¢ Gestures:
  - Swipe to refresh
  - Pull to refresh
  - Long press for context (future)

ğŸ’  12.3 Error Handling

â€¢ User-friendly error messages
â€¢ Validation feedback
â€¢ Network error handling
â€¢ Graceful degradation
â€¢ Retry mechanisms

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

13. ğŸ”„ Workflows & User Journeys

ğŸ’  13.1 New User Journey

1. Download app â†’ Register
2. Enter username, display name, mobile, password
3. Account created â†’ Auto-login
4. Home screen â†’ Create room or join room
5. Add friends â†’ Start playing games
6. Earn points â†’ View leaderboards

ğŸ’  13.2 Game Creation Journey

1. Home â†’ Create/Join Room
2. Room Dashboard â†’ Select Members
3. Choose Game Format
4. Team Assignment â†’ Shuffle/Accept
5. Play Matches â†’ Submit Results
6. View Results â†’ Points Assigned
7. Return to Dashboard â†’ Start New Game

ğŸ’  13.3 Friend Discovery Journey

1. Top Scores â†’ Search Button
2. Enter search query (name/username/phone)
3. View Results â†’ Tap "Add Friend"
4. Friend Added â†’ View Profile
5. See Friend's Stats â†’ Play Together

ğŸ’  13.4 Unregistered Player Journey

1. Admin adds player with name + phone (unregistered)
2. Player participates in games
3. Points and stats stored in UnregisteredPlayer
4. Player registers with same phone number
5. System links all data automatically
6. Names replaced with system-generated IDs
7. Player becomes fully registered user

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

14. âœ… Success Metrics & Validation

ğŸ’  14.1 Technical Metrics

â€¢ API Response Time: < 500ms average
â€¢ Leaderboard Load Time: < 2 seconds
â€¢ Game Creation Time: < 3 seconds
â€¢ Point Assignment Accuracy: 100%
â€¢ Data Linking Accuracy: 100%
â€¢ Zero duplicate team assignments
â€¢ Zero duplicate game creation in same room

ğŸ’  14.2 User Experience Metrics

â€¢ 95% of games completed without confusion
â€¢ 80% users add at least 3 friends
â€¢ 70% weekly retention rate
â€¢ 90% search success rate
â€¢ 85% friend request acceptance rate

ğŸ’  14.3 Data Integrity

â€¢ All points correctly assigned
â€¢ All statistics accurately tracked
â€¢ All matches properly recorded
â€¢ All room memberships maintained
â€¢ All friend relationships preserved
â€¢ All unregistered player data linked correctly

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

15. ğŸš€ Future Enhancements

ğŸ’  15.1 Planned Features

â€¢ Live scoring per rally
â€¢ AI fair-team generator (based on skill levels)
â€¢ Video highlights integration
â€¢ Tournament bracket visualization
â€¢ Multi-admin mode for rooms
â€¢ In-app chat for room members
â€¢ Push notifications for:
  - Friend requests
  - Game invitations
  - Match updates
  - Achievement unlocks

ğŸ’  15.2 Potential Features

â€¢ Social media sharing
â€¢ Player skill ratings
â€¢ Match scheduling
â€¢ Court booking integration
â€¢ Equipment tracking
â€¢ Player notes and tags
â€¢ Custom tournament formats
â€¢ Leaderboard filters (by location, skill level)
â€¢ Team creation and management
â€¢ Spectator mode
â€¢ Match replays
â€¢ Statistics analytics dashboard

ğŸ’  15.3 Platform Expansion

â€¢ Web admin dashboard
â€¢ iOS app optimization
â€¢ Android app optimization
â€¢ Desktop web application
â€¢ API documentation portal
â€¢ Developer SDK

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

16. ğŸ”’ Security & Privacy

ğŸ’  16.1 Authentication

â€¢ JWT tokens with expiration
â€¢ Secure password hashing (bcrypt)
â€¢ Token refresh mechanism
â€¢ Logout clears all auth data

ğŸ’  16.2 Data Protection

â€¢ Phone numbers normalized and secured
â€¢ Password never stored in plain text
â€¢ API endpoints protected with middleware
â€¢ Input validation on all forms
â€¢ SQL injection prevention (MongoDB)
â€¢ XSS prevention in frontend

ğŸ’  16.3 Privacy Controls

â€¢ User controls phone number visibility
â€¢ Search requires minimum digits (7 for phone)
â€¢ System-generated names for privacy
â€¢ Friend-only data sharing options
â€¢ Data export functionality (future)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

17. ğŸ“ Testing & Quality Assurance

ğŸ’  17.1 Test Coverage

â€¢ Comprehensive game logic tests
â€¢ Points calculation verification
â€¢ Medal assignment validation
â€¢ Data linking tests
â€¢ API endpoint tests
â€¢ Frontend component tests

ğŸ’  17.2 Test Files

â€¢ `comprehensive_game_test.js` - Full game flow testing
â€¢ `profile_statistics_test.js` - Profile stats validation
â€¢ `test_unregistered_player_flow.js` - Unregistered player linking
â€¢ Various format-specific tests

ğŸ’  17.3 Quality Checks

â€¢ All game formats tested
â€¢ All point calculations verified
â€¢ All medal assignments validated
â€¢ All data migrations tested
â€¢ All edge cases handled

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

18. ğŸ“ Support & Documentation

ğŸ’  18.1 User Support

â€¢ In-app help sections (future)
â€¢ FAQ section (future)
â€¢ Contact support (future)
â€¢ Bug reporting (future)

ğŸ’  18.2 Developer Documentation

â€¢ API documentation
â€¢ Code comments
â€¢ Architecture diagrams
â€¢ Deployment guides
â€¢ Testing guides

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

END OF PRD

This document serves as the comprehensive reference for the PickleMatch application.
All features described above have been implemented and are currently active.

For updates or modifications, please refer to the development team and update this document accordingly.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

